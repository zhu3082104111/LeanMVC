@using App_UI.Resource.ClientMessage
@using App_UI.Resource.ViewText.Common
@using App_UI.Resource.ViewText.Produce
@using Model

@section head{
    <link href="~/Scripts/js/InprocessingPlan/edojs/res/css/edo-all.css" rel="stylesheet" />
    <script src="~/Scripts/js/InprocessingPlan/edojs/edo.js" type="text/javascript"></script>
    <script src="~/Scripts/js/InprocessingPlan/ERP_v1.1.js" type="text/javascript"></script>
    <script src="~/Scripts/common/dialog.js"></script>

    <style>
        
        /*扩展日期框 开始*/
        .noborder {
            border-width: 0
        }
        .date-text {
            vertical-align: baseline;height: 20px;width: 80px;
        }
        .datebox-container {
            width: 100px;overflow: hidden;
        }
        .haveborder {
            border: 1px solid #95B8E7;display: inline-block;height: 20px;
        }
        /*扩展日期框 结束*/


        * {
            cursor: default;
        }

        .resizeDiv {
            position: absolute;
            background-color: #49eb1a;
            width: 0;
            height: 17px;
            left: 0;
            border: 0 solid blue;
            display: block;
        }

        .selectHeader, .selectLast {
            height: 100%;
            border: 0 solid red;
            position: absolute;
            background-color: #3629e0;
            opacity: 0.1;
            filter: alpha(opacity=10);
        }

        .selectHeader {
            left: 0;
            cursor: w-resize;
            width: 3px;
        }

        .selectLast {
            left: 100%;
            cursor: e-resize;
            width: 4px;
        }

        .onborder {
            border: none;
        }

        .e-table-header, .e-table-header-row {
            background-image: none;
        }

        /*datagrid*/
        .datagrid > div {
            text-align: left;
        }
        div.datagrid div.datagrid-cell {
            height: auto;
        }
        /*居中*/
        #tabsContainer > div {
            margin: auto;
        }
        /*列高度*/
        div.datagridTable .datagrid-body tr, div.datagridTable .datagrid-body tr {
            height: 30px;
        }
        /*表头高度*/
        div.datagridTable .datagrid-header-row {
            height: 24px;
        }
        div.datagridTable div.datagrid-cell {
            height: auto
        }

        div.datagridTable .datagrid-header-row {
            height: 24px;
        }

        div.datagridTable > div > div, div.datagridTable > div > div {
            border-right: none;
        }

        /*列高度*/
        #monthTable table tr {
            height: 30px;
        }
        /*不显示左边线*/
        #monthTable > div {
            border-left: none;
        }
        /*表头背景*/
        #monthTable div.e-table-header {
            background-color: white;
        }

        /* #weekTable div.e-table-header > div, #monthTable div.e-table-header > div {
            border-color: #cccccc;
        }*/

        #monthTable div.e-table-header > div > div {
            border-bottom: 1px dotted #ccc;
            border-right: 1px dotted #ccc;
        }

        .e-table-cell {
            border-bottom: 1px dotted #CCCCCC;
            border-right: 1px dotted #CCCCCC;
        }

        /*tab*/
        #InProcessTabs {
            border-left-width: 0;
        }

        /*其他*/
        /*select, input {
            vertical-align: middle; 
            border-style: solid;
            border-width: 1px;
            border-color: #95B8E7;
            vertical-align: middle;
        }*/

        /*select {
            width: auto;
            height: auto;
        }

        input {
            width: 110px;
            height: 20px;
        }*/

        /*td input {
            vertical-align: baseline;
        }*/

        .datagrid-row-selected, .e-table-row-selected {
            background-color: white;
        }

        .selected {
            background-color: #daa520;
            opacity: 0.5;
            filter: alpha(opacity=50);
        }

        .combobox-item-hover {
            background-color: #cccccc;
        }

        #mainPanle .mainTitle {
            font-size: 18pt;
        }


        /*拖动条的颜色*/
        .fullMaterial {
            background-color: #00B050
        }
        .someMaterial {
            background-color: #FFC000
        }
        .noMaterial {
            background-color: #d2691e
        }

        body {
            background: none;
            background-color: #DCE2F1
        }
    </style>

    <script>
        
        //扩展的datebox 开始
        (function($) {
            $.fn.extendDatebox = function(option) { //jQuery扩展方法,依赖于easyui-datebox
                var dateboxData = $.fn.extendDatebox.data;
                var $span = dateboxData.span;
                var $this = $(this);
                var $input = dateboxData.input;
                if ($span.length == 0) {
                    $input = $("<input id='_input_forDatebox' type='text'/>").appendTo("body").hide().datebox({
                        onSelect: function(date) {
                            var dateStr = $.fn.datebox.defaults.formatter(date);
                            var $currInput = $(this).data("curr");
                            var val = $currInput.val();
                            var r = true;
                            if (val != dateStr) {
                                r = $.fn.extendDatebox.events.onChange.call($currInput, dateStr, val);
                            }
                            if (r !== false) {
                                $currInput.val(dateStr); //为当前input赋值
                            }
                        },
                        onHidePanel: function() {
                            $span.hide();
                        }
                    });
                    $span = $input.next();
                    $span.css("position", "absolute");
                    $span.attr("id", "_forDatebox").hide();
                    dateboxData.span = $span;
                    dateboxData.input = $input;
                    $("body").on("click", "a.datebox-clear", function(event) { //清空按钮绑定事件
                        $input.data("curr").val(""); //清空
                        $(this).next().trigger("click"); //关闭
                    });
                }
                $input.data("curr", $this); //当前input元素
                var $inputSpan = $this.parent();
                $span.css({
                    height: $this.height(),
                    width: $this.width() + 1
                });
                $input.datebox("setValue", $this.val());
                var offset = $inputSpan.offset();
                $span.show().find("span").hide().end().css({ top: offset.top + "px", left: offset.left + "px" });
                if (dateboxData.triggerEle.length == 0) {
                    dateboxData.triggerEle = $span.find("span > span");
                }
                dateboxData.triggerEle.trigger("click");
            };
            $.fn.extendDatebox.data = {
                //存放一些不改变的元素，提高效率
                span: [],//easyui 生成的span
                input: [],//span下的input
                triggerEle: []//span下可以点击的span(触发事件)
            };
            $.fn.extendDatebox.events = {
                onbeforeOpen: function(val) {
                },
                onChange: function(newVal, oldVal) {
                    if (newVal == "2013-12-13") {
                        return false;
                    }
                    return true;
                }
            };
            window.extendDatebox = function(obj) {
                if (obj) {
                    $(obj).extendDatebox({});
                }
            };
        }(jQuery));


        //扩展的datebox 结束
        (function($) {
            var table = "#easyTable"; //中计划表格
            var DMPForm = "#DMPForm"; //detailMonthProcessForm
            var mTable; //原料确认表格

            var fieldNames = {};

            /***********operations start***************/
            //查询
            window.searchFun = function() {
                table.datagrid("load");
            };

            //保存 到生产排期计划
            window.saveAssemblePlanFun = function(options) { //总装计划保存
                console.time("form");
                var formData = { IsPlaned: "", OrderId: "", OrderDetail: "", ExportId: "", ProcessId: "", ProductId: "", ScheduStartDt: "", ScheduEndDt: "", ScheduQuanlity: "" };
                var $startInputs = table.datagrid("getColumnJqByField", "ScheduStartDt").find("input"); //开始日期的input元素
                var $endInputs = table.datagrid("getColumnJqByField", "ScheduEndDt").find("input"); //结束日期的input元素
                for (var i = 0, len = $startInputs.length; i < len; i++) {
                    var $startInput = $($startInputs[i]);
                    var ids = $startInput.attr("targetId").split(",");
                    formData.IsPlaned += $startInput.attr("isPlaned") + ",";
                    formData.OrderId += ids[0] + ",";
                    formData.OrderDetail += ids[1] + ",";
                    formData.ExportId += ids[2] + ",";
                    formData.ProcessId += $startInput.attr("processId") + ",";
                    formData.ProductId += $startInput.attr("productId") + ",";
                    formData.ScheduQuanlity += $startInput.attr("scheduQuanlity") + ",";
                    formData.ScheduStartDt += $startInput.val() + ",";
                    formData.ScheduEndDt += $($endInputs[i]).val() + ",";
                }
                formData.ProductType = "@Constant.ProduceType.ASSEM" + ","; //生产类型
                //console.info(formData);
                $.messager.progress({ msg: "@VT_InProcessing.DataProcessing", text: "" });
                options = options || {};
                if (options.nextDo) {
                    $("#saveForm").data("nextDo", options.nextDo);
                }
                //[url, onSubmit, success, onLoadError]
                $("#saveForm").formSubmit([
                    "/Produce/InProcessingPlan/EditProduceSchedu",
                    function(param) {
                        for (var d in formData) {
                            param[d] = formData[d].replace(/,$/, "");
                        }
                    },
                    function(data) {
                        $.messager.progress("close");
                        var mess = eval('(' + data + ')');
                        var result = mess.result;
                        if (result.result === true) {
                            ERP.Variables.changedRecord = [];
                            if ($("#saveForm").data("nextDo")) {
                                $("#saveForm").data("nextDo").call(true);
                            }
                            table.datagrid("reload");
                            $.messager.alert("@VT_Common.Tips", "@CM_Common.MSG0003");
                        } else {
                            $.messager.alert("@VT_Common.Tips", "@CM_Common.MSG0004，详情：<br/>" + result.mess);
                        }
                    },
                    function() {
                        $.messager.progress("close");
                    }
                ]);
                console.timeEnd("form");
            };


            //关闭
            window.closeFun = function() {
                if (ERP.Variables.changedRecord.length == 0) { //没有变化时不提交
                    //parent.addTab(parent.gTitle, "/Produce/FAPlan/Index");
                    parent.closeTab();
                    return;
                }
                $.messager.confirm("@VT_Common.Tips", "@CM_Produce.DLG40104001", function(r) {
                    if (r) {
                        saveAssemblePlanFun({
                            nextDo: function() {
                                parent.closeTab();
                            }
                        });
                    } else {
                        parent.closeTab();
                    }

                });
            };

            //原料确认按钮的点击事件
            window.materialConfirm = function(index) {
                $("#materialConfirmDialog").dialog({ modal: true }).dialog("open").data("rowIndex", index);
                mTable.datagrid("loadData", { result: { rows: [] } });
                mTable.datagrid("options").url = "/Produce/FAPlan/GetMatetialQuanlity";
                var rows = table.datagrid("getData").rows;
                var row = rows[index];
                mTable.datagrid("load", {
                    OrderId: row["OrderId"],
                    OrderDetail: row["OrderDetail"],
                    ExportId: row["ExportId"]
                });
                //alert(index);
            };

            //调度单生成按钮的点击事件
            window.dispatchCreate = function(index) {
                var row = table.datagrid("getData").rows[index];
                var param = "";
                param += "customerOrderId=" + row["OrderId"]; //客户订单号
                param += "&customerOrderDetails=" + row["OrderDetail"]; //订单明细
                param += "&productId=" + (row["ProductId"]?row["ProductId"]:""); //产品ID
                param += "&prodAbbrev=" + (row["ProductAbbrev"]?row["ProductAbbrev"]:""); //产品略称
                param += "&assemblyPlanNum=" + (row["MaterialQuanlity"]?row["MaterialQuanlity"]:0); //原料数量
                parent.addTab("调度单生成", "Produce/FAScheduleBill/AddNewBill?" + param);
                //alert(index);
            };

            //原料确认按钮--字符串
            var materialConfirmBtn = function() {
                return '@UserHelpers.ButtonForMaterialConfirm("{0}")';
            };
            //调度单生成按钮--字符串
            var dispatchCreateBtn = function() {
                return '@UserHelpers.ButtonForSchedulingNotice("{0}")';
            };

            //自定义“扩展datebox”的onchange事件
            $.extend($.fn.extendDatebox.events, {
                onChange: function(newVal, oldVal) {
                    return dataChange(this, newVal);
                }
            });
            //生成扩展的datebox
            var formatterInput = function(name, className, other) {
                var str = "<span class=\"datebox haveborder datebox-container\" style='width:90px;'>" +
                    "<input type=\"text\" style='width:70px;' class=\"noborder date-text " + className +
                    "\" name=\"" + name + "\" " + other + " /><span class=\"combo-arrow extend-datebox\"" +
                    " onclick=\"onclickDatebox(this,event);\"></span></span>";
                return str;
            };

            //生成隐藏的input元素
            var createInputHidden = function(name, value, other) {
                var args = $.extend([], ["", "", ""],arguments);
                return "<input type='hidden' name='" + args[0] + "' value='" + args[1] + "' " + args[2] + " />";
            };

            //datebox按钮点击事件，打开datebox
            window.onclickDatebox = function(obj, evt) {
                var $input = $(obj).prev();
                dbClick($input);
                $input.extendDatebox({});
            };

            /***********operations end***************/
            //中计划列属性
            var getMiddlePlanColumns = function() {
                //列属性: field(字段名,非空) , title(列名) , width(默认80), rowspan,colspan, sortable(默认false) , editor(默认null) , formatter(默认-函数)
                var columns = [[], []];
                columns[0].push(["OrderId", "@VT_InProcessing.OrderId", 130, 2, 1, true]);
                columns[0].push(["ProductAbbrev", "@VT_InProcessing.ProductId", 100, 2, 1, true]);
                columns[0].push(["Specifica", "@VT_InProcessing.Specifica", 130, 2, 1, true]);
                columns[0].push(["AssembleQuantity", "@VT_FAScheduleBill.AssembleQuanlity", 70, 2, 1, true,null,function(value, row) {
                    if (!row["IsPlaned"]) {
                        return "-";
                    }
                    return value;
                }]);
                columns[0].push(["MaterialQuanlity", "@VT_FAScheduleBill.MaterialQuanlity", 70, 2, 1, false, null, function(value, row, index) {
                    if (value) {
                        return value;
                    }
                    return materialConfirmBtn().replace("{0}", "materialConfirm(" + index + ")");
                }]);
                columns[0].push(["DispatchIds", "@VT_FAScheduleBill.DispatchId", 120, 2, 1, false, null, function(value, row, index) {
                    var strHtml = "";
                    
                    if (row["MaterialQuanlity"] > 0) {
                        strHtml = dispatchCreateBtn().replace("{0}", "dispatchCreate(" + index + ")");
                    }
                    for (var i = 0, len = value.length; i < len; i++) {
                        strHtml += createInputHidden("", value[i]);
                    }
                    return strHtml;
                }]);
                columns[0].push(["", "@VT_InProcessing.ScheduPlan", null, 1, 2]);
                columns[0].push(["", "@VT_InProcessing.ScheduPlan", null, 1, 2]);
                columns[1].push(["StartDt", "@VT_InProcessing.StartDate", 90, 1, 1, true]);
                columns[1].push(["ProvideDt", "@VT_InProcessing.ProvideDay", 90, 1, 1, true]);
                columns[1].push(["ScheduStartDt", "@VT_InProcessing.StartDay", 100, 1, 1, false, null, function(value, row, index) {
                    var htmlStr = " processId='" + row["ProcessId"] + "' productId='" + row["ProductId"] + "' scheduQuanlity='" + row["ScheduQuanlity"] + "' isPlaned='" + row["IsPlaned"] + "' targetID='" + row["OrderId"] + "," + row["OrderDetail"] + "," + row["ExportId"] +
                        "' model='start'" + " value='" + DateFormatter(value) + "' readonly='true'";
                    return formatterInput("", "", htmlStr);
                }]);
                columns[1].push(["ScheduEndDt", "@VT_InProcessing.FinishDay", 100, 1, 1, false, null, function(value, row, index) {
                    var htmlStr = " targetID='" + row["OrderId"] + "," + row["OrderDetail"] + "," + row["ExportId"] +
                        "' model='end'" + " value='" + DateFormatter(value) + "' readonly='true'";
                    return formatterInput("", "", htmlStr);
                }]);
                return columns;
            };

            var monthTableOption = {
                renderDiv: "#monthTable",
                viewType: "day",
                columnWidth: 20,
                width: 350
            };

            //创建edo表格
            var createEdoTable = function(option) {
                createTable(option);
                ERP.Util({ provider: option.renderDiv, scroller: option.renderDiv + " div.e-table-viewport" });
            };


            var dataIsNull = false; //标识是否为空数据
            //中计划-表格
            var createMiddlePlanGrid = function() {
                Common.Functions.createDataGrid({
                    target: table,
                    url: "/Produce/FAPlan/GetAssembleMiddlePlan",
                    columns: getMiddlePlanColumns(),
                    sortName: "OrderId,ProductId",
                    sortOrder: "asc,desc",//多字段排序
                    pageSize: 10,
                    pageList: [10, 15],
                    maxHeight: 500,
                    //checkbox: true,
                    //striped: true,
                    onBeforeLoad: function(param) {
                        if (ERP.Variables.changedRecord.length != 0) { //没有变化时不提交
                            setTimeout(function() {
                                $.messager.confirm("@VT_Common.Tips", "@CM_Produce.DLG40104001", function(r) {
                                    console.info(r);
                                    if (r) {
                                        saveAssemblePlanFun();
                                    } else {
                                        ERP.Variables.changedRecord = [];
                                        table.datagrid("reload");
                                    }
                                });
                            }, 10);
                            return false;
                        }
                        var formArr = DMPForm.serializeArray();
                        for (var i = 0, len = formArr.length; i < len; i++) {
                            param[formArr[i]["name"]] = formArr[i]["value"];
                        }
                        param["IsSearch"] = true;
                        dataIsNull = false;
                        return true;
                    },
                    onCreating: function(data) {
                        setTimeout(function() { //创建拖动区域
                            if (dataIsNull) {
                                $("#monthTable").hide();
                                return;
                            }
                            $("#monthTable").show();
                            var tableOption = monthTableOption;
                            tableOption.data = data.rows;
                            createEdoTable(tableOption);
                            var $columns = table.datagrid("getColumnJqByField", "DispatchIds");
                            for (var i = 0, len = $columns.length; i < len; i++) {
                                var $column = $($columns[i]);
                                var content = $column.attr("field");
                                $column.tooltip({
                                    onShow:function(e) {
                                        var $inputHiddens = $(this).children("div").children("input:hidden");
                                        if ($inputHiddens.length == 0 || $(this).children("div").children("input:button").length!=0) {
                                            $(this).tooltip("tip").hide();
                                            return;
                                        }
                                        var values = "";
                                        for (var i = 0, len = $inputHiddens.length; i < len; i++) {
                                            values += $($inputHiddens[i]).val() + "<br/>";
                                        }
                                        $(this).tooltip("update", values);
                                    }
                            });
                            }
                        }, 10);
                    },
                    loadFilter: function(data) {
                        var Data = {};
                        Data.rows = data.rows ? data.rows : data;
                        Data.total = data.total ? data.total : 0;
                        AdaptDt(this, Data.rows, "StartDt,ProvideDt,ScheduStartDt,ScheduEndDt");
                        return Data;
                    }
                });
            };

            $(function() {
                table = $(table); //中计划表格
                DMPForm = $(DMPForm); //detailMonthProcessForm

                ERP.Variables.changedRecord.length = 0; //清除修改记录,保证不影响本次修改
                fieldNames = ERP.Variables.fieldNames;
                fieldNames.ids = { orderId: "OrderId", orderDetail: "OrderDetail", exportId: "ExportId" };
                //fieldNames.id = "OrderId";
                fieldNames.startDate = "ScheduStartDt";
                fieldNames.endDate = "ScheduEndDt";
                ERP.Variables.UserId = ERP.Variables.UserIds.fyy;

                createMiddlePlanGrid();
            });

            //原料确认相关操作
            $(function() {
                mTable = $("#materialTable");

                //确定按钮
                window.clickOK = function() {
                    var $DatagridmaterialColumns = table.datagrid("getColumnJqByField", "MaterialQuanlity");
                    var mainRows = table.datagrid("getData").rows;
                    var minQuanlity = mTable.datagrid("getData").footer[0]["RealInQuanlity"];
                    var rowIndex = $("#materialConfirmDialog").data("rowIndex") - 0;
                    mainRows[rowIndex]["MaterialQuanlity"] = minQuanlity;
                    $("#materialConfirmDialog").dialog("close");
                    $($DatagridmaterialColumns[rowIndex]).children().html(minQuanlity);
                    table.datagrid("refreshColumn", "DispatchIds");
                };

                //列属性
                var getMColumns = function() {
                    var columns = [[]];
                    //列属性: field(字段名,非空) , title(列名) , width(默认80), sortable(默认false) , editor(默认null) , formatter(默认-函数)
                    columns[0].push(["ExportAbbrev", "@VT_FAScheduleBill.ExportAbbrev", 200, false, null]);
                    columns[0].push(["RealInQuanlity", "@VT_FAScheduleBill.RealInQuanlity", 120, false, null]);
                    return columns;
                };

                Common.Functions.createDataGrid({
                    target: mTable,
                    columns: getMColumns(),
                    pagination: false,
                    showFooter: true,
                    maxHeight: 260,
                    maxWidth: 400,
                    onBeforeLoad:function(param) {
                        $("#materialOKBtn").prop("disabled", true);//禁用“确定”按钮，以免取数据出错
                    },
                    loadFilter: function (data) {
                        $("#materialOKBtn").prop("disabled", false);
                        return data.result;
                    }
                });

            });


            $(function () {
                $("#productDlg").dialog({
                    buttons: "#dlgBtns",
                    cache: false,
                    height: 450,
                    //href: "/Technology/ProdInfo/ShowProdInfoDialog?singleSelect=true",
                    modal: true,
                    width: 930,
                    closed: true,
                    title: "<span style=\" font-family:Tahoma,Verdana,微软雅黑,新宋体;font-size:16px;margin:0px;padding:0px; \">产品信息一览</span>",
                    onBeforeOpen: function () {
                        var top = $(document).scrollTop() + ($(window)._outerHeight() - $(this).dialog("options").height) / 2;
                        var left = $(document).scrollLeft() + ($(window)._outerWidth() - $(this).dialog("options").width) / 2;
                        if (top < 10) {
                            top = $(document).scrollTop() + 10;
                        }
                        if (left < 10) {
                            left = $(document).scrollLeft() + 10;
                        }
                        $(this).dialog("move", { top: top, left: left });
                    }
                });

                //打开“产品型号”对话框
                window.showProductDlgFun = function (obj) {
                    $("#productDlg").dialog("open").dialog("refresh", "/Technology/ProdInfo/ShowProdInfoDialog?singleSelect=true")
                        .data("currTarget", $(obj));
                };
                //“产品型号”对话框“确定”按钮
                window.productDlgOKFun = function () {
                    var selectedRow = null;
                    try {
                        selectedRow = $("#ProdInfoDialogTable").datagrid("getSelected"); //选择的行数据
                    } catch(e) {
                        selectedRow = null;
                    }
                    if (!selectedRow) {
                        $.messager.alert("@VT_Common.Tips", "@CM_Produce.CK40502002");
                            return;
                        }
                    var $spanBtn = $("#productDlg").dialog("close").data("currTarget");//放大镜元素
                    var $span = $spanBtn.parent().parent();//span元素
                    $span.children("input").val(selectedRow["ProductAbbreviation"]);
                    $span.prev().val(selectedRow["ProductID"]);
                };
                
                //打开“客户订单”对话框
                window.showOrderDlgFun = function (ele) {
                    CommonDlgFun.ShowOrderDlg.call(ele, '#orderDlg');
                };

                //“客户订单”对话框“选择”按钮
                window.orderDlgOKFun = function () {
                    var row = CommonDlgFun.GetSelectedOrder();
                    if (!row) {
                        $.messager.alert("@VT_Common.Tips", "@CM_Produce.CK40502002");
                        return;
                    }
                    $("#orderDlg").dialog("close").data("currTarget").parent().prev().val(row["ClientOrderID"]);

                };
                
            });

        }(jQuery));

    </script>

}

@*buttons*@
<div style="margin:20px 10px 10px auto;text-align:right;">
    @UserHelpers.ButtonForCapacityAnalysis("",""," disabled='disabled'")
    @UserHelpers.ButtonForSave("saveAssemblePlanFun()")
    @UserHelpers.ButtonForClose("closeFun()")
</div>

@*title*@
<div style="text-align: center;">
    @UserHelpers.Line()
    @UserHelpers.Company_Title(VT_Common.CompanyName)
    @UserHelpers.Title(VT_FAScheduleBill.AssembleMiddlePlanTitle)
</div>

@*form*@
<div style="margin:10px 0;width:auto;margin: 10px auto;">
    <form id="DMPForm" class="Search_Form">
        <div style="width: 870px;margin: auto;">
            <div style="text-align: left;">
                <span>@VT_InProcessing.OrderId：@UserHelpers.InputReadOnly("OrderId","showOrderDlgFun(this)","20")</span>
                <span style="margin-left: 15px;">@VT_InProcessing.ProductId：<input type="hidden" name="ProductId"/>@UserHelpers.InputReadOnly("ProductName","showProductDlgFun(this)","15")</span>
                <span style="margin-left: 59px;">@VT_InProcessing.Specifica：@UserHelpers.InputSimple("Specifica"," maxlength=200 ")</span>
            </div>
            <div style="text-align: left;margin-top:10px;">
                <span>@Html.Raw(VT_InProcessing.ProvideDate)：@UserHelpers.TimeBeginInput("StartDt","StartDt","StartDt")</span>
                <span style="">~ @UserHelpers.TimeEndInput("EndDt","EndDt","EndDt")</span>
                <span style="margin-left:305px;">@UserHelpers.ButtonForSearch("searchFun('middle')","SearchBtn")</span>
            </div>
        </div>
    </form>
</div>

@*table*@
<div style="width:100%;text-align: center;">
    <div style="width: 1080px;margin:auto;">
        <div class="DMPD datagridTable" style="float:left;width:678px;">
            <table id="easyTable"></table>
        </div>
        <div class="container" style="float:left;width:356px;">
            <div id="monthTable" style=""></div>
        </div>
    </div>
</div>

@*other*@
<div class="dialogContainer">
    <div id="materialConfirmDialog" class="easyui-dialog" data-options="{title:'原料确认',closed:true,width:400,height:400}">
        <div></div>
        <div style="text-align: center;margin-top: 20px;">
            <div class="datagridTable">
                <div id="materialTable"></div>
            </div>
        </div>
        <div style="bottom:10px;right:10px;position:absolute;">
            @UserHelpers.ButtonForConfirmation("clickOK()","materialOKBtn")
            @*@UserHelpers.ButtonForClose("")*@
        </div>
    </div>
</div>


<form id="saveForm" style="display: none;" method="POST"></form>

@*产品型号dialog相关*@
<div>
    <div id="productDlg"></div>
</div>
<div id="dlgBtns">
    @UserHelpers.ButtonForAdd("productDlgOKFun()")
    @UserHelpers.ButtonForClose("$('#productDlg').dialog('close');")
</div>

@*客户订单号dialog相关*@
<div>
    <div id="orderDlg" data-options="buttons:'#orderDlgBtns'"></div>
</div>
<div id="orderDlgBtns" style="display: none;">
    @UserHelpers.ButtonForChoose("orderDlgOKFun();")
    @UserHelpers.ButtonForClose("$('#orderDlg').dialog('close');")
</div>