@using App_UI.Resource.ClientMessage
@using App_UI.Resource.ViewText.Common
@using App_UI.Resource.ViewText.Produce
@using Model

@section head{
    <link href="~/Scripts/js/InprocessingPlan/edojs/res/css/edo-all.css" rel="stylesheet" />
    <script src="~/Scripts/js/InprocessingPlan/edojs/edo.js" type="text/javascript"></script>
    <script src="~/Scripts/js/InprocessingPlan/ERP_v1.1.js" type="text/javascript"></script>
    <script src="~/Scripts/common/dialog.js"></script>

    <style>
        
        /*日期框 开始*/
        .noborder {
            border-width: 0
        }
        .date-text {
            vertical-align: baseline;height: 20px;width: 80px;
        }
        .datebox-container {
            width: 100px;overflow: hidden;
        }
        .haveborder {
            border: 1px solid #95B8E7;display: inline-block;height: 20px;
        }
        /*日期框 结束*/


        * {
            cursor: default;
        }

        .resizeDiv {
            position: absolute;
            background-color: #49eb1a;
            width: 0;
            height: 17px;
            left: 0;
            border: 0 solid blue;
            display: block;
        }

        .selectHeader, .selectLast {
            height: 100%;
            border: 0 solid red;
            position: absolute;
            background-color: #3629e0;
            opacity: 0.1;
            filter: alpha(opacity=10);
        }

        .selectHeader {
            left: 0;
            cursor: w-resize;
            width: 3px;
        }

        .selectLast {
            left: 100%;
            cursor: e-resize;
            width: 4px;
        }

        .onborder {
            border: none;
        }

        .e-table-header, .e-table-header-row {
            background-image: none;
        }

        /*datagrid*/
        .datagrid > div {
            text-align: left;
        }
        div.datagrid div.datagrid-cell {
            height: auto;
        }
        /*居中*/
        #tabsContainer > div {
            margin: auto;
        }
        /*列高度*/
        div.DMPD .datagrid-body tr, div.DWPD .datagrid-body tr {
            height: 30px;
        }
        /*表头高度*/
        div.DMPD .datagrid-header-row {
            height: 24px;
        }
        div.databrid div.datagrid-cell {
            height: auto
        }

        div.DWPD .datagrid-header-row {
            height: 24px;
        }

        div.DWPD > div > div, div.DMPD > div > div {
            border-right: none;
        }

        /*列高度*/
        #monthTable table tr, #weekTable table tr {
            height: 30px;
        }
        /*不显示左边线*/
        #monthTable > div, #weekTable > div {
            border-left: none;
        }
        /*表头背景*/
        #weekTable div.e-table-header, #monthTable div.e-table-header {
            background-color: white;
        }

        /* #weekTable div.e-table-header > div, #monthTable div.e-table-header > div {
            border-color: #cccccc;
        }*/

        #weekTable div.e-table-header > div > div, #monthTable div.e-table-header > div > div {
            border-bottom: 1px dotted #ccc;
            border-right: 1px dotted #ccc;
        }

        .e-table-cell {
            border-bottom: 1px dotted #CCCCCC;
            border-right: 1px dotted #CCCCCC;
        }

        /*tab*/
        #InProcessTabs {
            border-left-width: 0;
        }

        .datagrid-row-selected, .e-table-row-selected {
            background-color: white;
        }

        .selected {
            background-color: #daa520;
            opacity: 0.5;
            filter: alpha(opacity=50);
        }

        .combobox-item-hover {
            background-color: #cccccc;
        }

        #mainPanle .mainTitle {
            font-size: 18pt;
        }

        /*拖动条的颜色*/
        .fullMaterial {
            background-color: #00B050
        }
        .someMaterial {
            background-color: #FFC000
        }
        .noMaterial {
            background-color: #d2691e
        }

        body {
            background: none;
            background-color: #DCE2F1
        }
    </style>

    <script>
        
        //扩展的datebox 开始
        (function($) {
            $.fn.extendDatebox = function(option) { //jQuery扩展方法,依赖于easyui-datebox
                var dateboxData = $.fn.extendDatebox.data;
                var $span = dateboxData.span;
                var $this = $(this);
                var $input = dateboxData.input;
                if ($span.length == 0) {
                    $input = $("<input id='_input_forDatebox' type='text'/>").appendTo("body").hide().datebox({
                        onSelect: function(date) {
                            var dateStr = $.fn.datebox.defaults.formatter(date);
                            var $currInput = $(this).data("curr");
                            var val = $currInput.val();
                            var r = true;
                            if (val != dateStr) {
                                r = $.fn.extendDatebox.events.onChange.call($currInput, dateStr, val);
                            }
                            if (r !== false) {
                                $currInput.val(dateStr); //为当前input赋值
                            }
                        },
                        onHidePanel: function() {
                            $span.hide();
                        },
                        clearable:false
                    });
                    $span = $input.next();
                    $span.css("position", "absolute");
                    $span.attr("id", "_forDatebox").hide();
                    dateboxData.span = $span;
                    dateboxData.input = $input;
                    $("body").on("click", "a.datebox-clear", function(event) { //清空按钮绑定事件
                        $input.data("curr").val(""); //清空
                        $(this).next().trigger("click"); //关闭
                    });
                }
                $input.data("curr", $this); //当前input元素
                var $inputSpan = $this.parent();
                $span.css({
                    height: $this.height(),
                    width: $this.width() + 1
                });
                $input.datebox("setValue", $this.val());
                var offset = $inputSpan.offset();
                $span.show().find("span").hide().end().css({ top: offset.top + "px", left: offset.left + "px" });
                if (dateboxData.triggerEle.length == 0) {
                    dateboxData.triggerEle = $span.find("span > span");
                }
                dateboxData.triggerEle.trigger("click");
            };
            $.fn.extendDatebox.data = {
                //存放一些不改变的元素，提高效率
                span: [],//easyui 生成的span
                input: [],//span下的input
                triggerEle: []//span下可以点击的span(触发事件)
            };
            $.fn.extendDatebox.events = {
                onbeforeOpen: function(val) {
                },
                onChange: function(newVal, oldVal) {
                    if (newVal == "2013-12-13") {
                        return false;
                    }
                    return true;
                }
            };
            window.extendDatebox = function(obj) {
                if (obj) {
                    $(obj).extendDatebox({});
                }
            };

            $(function() {
                $(document).on("click", "span.extend-datebox", function() {
                    //extendDatebox($(this).prev());
                    //$.fn.extendDatebox.events["onbeforeOpen"].call(this, $input.val());
                    //$(this).prev().extendDatebox({});
                });
                /*$("span.extend-datebox").on("click", function() {
                    var $input = $(this).prev();
                    $.fn.extendDatebox.events["onbeforeOpen"].call(this, $input.val());
                    $input.extendDatebox({});
                });*/
            });
        }(jQuery));
        

        //扩展的datebox 结束
        (function($) {

            var DMPTable = "#DMPTable"; //中计划表格
            var DMPForm = "#DMPForm"; //detailMonthProcessForm

            var fieldNames = {};

            /***********operations start***************/
            //搜索
            window.searchMiddlePlanFun = function(middleOrLittle) {
                DMPTable.datagrid("load");
            };

            //转到加工流转卡
            window.toCirculationCard = function() {
                var selections = DMPTable.datagrid("getSelections");
                console.info("selections:", selections);
                if (selections.length == 0) {
                    $.messager.alert("@VT_Common.Tips", "@CM_Produce.CK40104004");
                    return;
                }
                var firstExportId = selections[0]["ExportId"]; //第一个零件ID，用于比较零件ID是否都相同
                var firstSpecifica = selections[0]["Specifica"];//第一个零件ID，用于比较物料规格要求是否都相同
                for (var i = 0, len = selections.length; i < len; i++) {
                    if (selections[i]["ExportId"] != firstExportId) {
                        $.messager.alert("@VT_Common.Tips", "@Html.Raw(CM_Produce.CK40104001)");
                        return;
                    }
                    if (selections[i]["Specifica"] != firstSpecifica) {
                        $.messager.alert("@VT_Common.Tips", "@Html.Raw(CM_Produce.CK40104002)");
                        return;
                    }
                    if ((selections[i]["MaterialQuanlity"]-0) <= 0) {
                        $.messager.alert("@VT_Common.Tips", "@Html.Raw(CM_Produce.CK40104003)");
                        return;
                    }
                }

                var formData = { ExportId: "", ProcessId: "", OrderIds: "", OrderDetails: "",ProductIds:"", MaterialQuanlitys: "", ScheduStartDt: "", ScheduEndDt: "", Specifica: "" };
                formData.ExportId += (selections[0]["ExportId"]?selections[0]["ExportId"]:"") + ",";
                formData.ProcessId += (selections[0]["ProcessId"]?selections[0]["ProcessId"]:"") + ",";
                formData.Specifica += (selections[0]["Specifica"]?selections[0]["Specifica"]:"") + ",";
                for (var i = 0, len = selections.length; i < len; i++) {
                    formData.OrderIds += selections[i]["OrderId"] + ",";
                    formData.OrderDetails += selections[i]["OrderDetail"] + ",";
                    formData.ProductIds += selections[i]["ProductId"] + ",";
                    formData.MaterialQuanlitys += selections[i]["MaterialQuanlity"] + ",";
                    formData.ScheduStartDt += selections[i]["ScheduStartDt"] + ",";
                    formData.ScheduEndDt += selections[i]["ScheduEndDt"] + ",";
                }
                $.messager.progress({ msg: "@VT_InProcessing.DataProcessing", text: "" });
                //[url, onSubmit, success, onLoadError]
                $("#saveForm").formSubmit([
                    "/Produce/InProcessingPlan/AddTranslateCard",
                    function(param) {
                        for (var d in formData) {
                            param[d] = formData[d].replace(/,$/, "");
                        }
                    },
                    function(data) {
                        var mess = eval('(' + data + ')');
                        var result = mess.result;
                        console.info(result);
                        $.messager.progress("close");
                        if (result.result === true) {
                            setTimeout(function() {
                                parent.addTab("@VT_InProcessing.TranslationCardPlan", "/Produce/CirculateCard/Edit?id=" + result["backId"]);
                            }, 20);
                            $.messager.alert("@VT_Common.Tips", "@CM_Common.MSG0003");
                        } else {
                            $.messager.alert("@VT_Common.Tips", "@CM_Common.MSG0004，详情：<br/>" + result.message);
                        }
                    },
                    function() {
                        $.messager.progress("close");
                    }
                ]);
            };

            //中计划保存
            window.saveMiddlePlanFun = function(options) {
                //if (ERP.Variables.changedRecord.length == 0) { //没有变化或无选中项时不提交
                //    return;
                //}
                console.time("form");
                var formData = { IsPlaned: "", OrderId: "", OrderDetail: "", ExportId: "", ProcessId: "", ProductId: "", ScheduStartDt: "", ScheduEndDt: "", ScheduQuanlity: "" };
                var $startInputs = DMPTable.datagrid("getColumnJqByField", "ScheduStartDt").find("input");
                var $endInputs = DMPTable.datagrid("getColumnJqByField", "ScheduEndDt").find("input");
                for (var i = 0, len = $startInputs.length; i < len; i++) {
                    var $startInput = $($startInputs[i]);
                    var ids = $startInput.attr("targetId").split(",");
                    formData.IsPlaned += $startInput.attr("isPlaned") + ",";
                    formData.OrderId += ids[0] + ",";
                    formData.OrderDetail += ids[1] + ",";
                    formData.ExportId += ids[2] + ",";
                    formData.ProcessId += $startInput.attr("processId") + ",";
                    formData.ProductId += $startInput.attr("productId") + ",";
                    formData.ScheduQuanlity += $startInput.attr("scheduQuanlity") + ",";
                    formData.ScheduStartDt += $startInput.val() + ",";
                    formData.ScheduEndDt += $($endInputs[i]).val() + ",";
                }
                //console.info(formData);
                //$.messager.progress({ msg: "@VT_InProcessing.DataProcessing", text: "" });
                options = options || {};
                if (options.nextDo) {
                    $("#saveForm").data("nextDo", options.nextDo);
                }
                //[url, onSubmit, success, onLoadError]
                $("#saveForm").formSubmit([
                    "/Produce/InProcessingPlan/EditProduceSchedu",
                    function(param) {
                        for (var d in formData) {
                            param[d] = formData[d].replace(/,$/, "");
                        }
                    },
                    function(data) {
                        $.messager.progress("close");
                        var mess = eval('(' + data + ')');
                        var result = mess.result;
                        if (result.result === true) {
                            ERP.Variables.changedRecord = [];
                            //console.info("保存成功,data:", data);
                            if ($("#saveForm").data("nextDo")) {
                                $("#saveForm").data("nextDo").call(true);
                            }
                            DMPTable.datagrid("reload");
                            $.messager.alert("@VT_Common.Tips", "@CM_Common.MSG0003");
                        } else {
                            $.messager.alert("@VT_Common.Tips", "@CM_Common.MSG0004，详情：<br/>" + result.mess);
                        }
                    },
                    function() {
                        //$.messager.progress("close");
                    }
                ]);
                console.timeEnd("form");
            };

            //关闭
            window.closeFun = function() {
                if (ERP.Variables.changedRecord.length == 0) { //没有变化时不提交
                    parent.closeTab();
                    //parent.addTab(parent.gTitle, "/Produce/InProcessingPlan/Index");
                    return;
                }
                $.messager.confirm("@VT_Common.Tips", "@CM_Produce.DLG40104001", function(r) {
                    if (r) {
                        saveMiddlePlanFun({
                            nextDo: function() {
                                parent.closeTab();
                            }
                        });
                    } else {
                        parent.closeTab();
                    }
                });
            };

            //自定义“扩展datebox”的onchange事件
            $.extend($.fn.extendDatebox.events, {
                onChange: function(newVal, oldVal) {
                    return dataChange(this, newVal);
                }
            });
            //生成扩展的datebox
            window.formatterInput = function(name, className, other) {
                var str = "<span class=\"datebox haveborder datebox-container\" style='width:90px;'>" +
                    "<input type=\"text\" style='width:70px;' class=\"noborder date-text " + className +
                    "\" name=\"" + name + "\" " + other + " /><span class=\"combo-arrow extend-datebox\"" +
                    " onclick=\"onclickDatebox(this,event);\"></span></span>";
                return str;
            };

            //datebox按钮点击事件，打开datebox
            window.onclickDatebox = function(obj, evt) {
                var $input = $(obj).prev();
                dbClick($input);
                $input.extendDatebox({});
            };

            /***********operations end***************/
            //中计划列属性
            var getMiddlePlanColumns = function() {
                //列属性: field(字段名,非空) , title(列名) , width(默认80), rowspan,colspan, sortable(默认false) , editor(默认null) , formatter(默认-函数)
                var columns = [[], []];
                columns[0].push(["OrderId", "@VT_InProcessing.OrderId", 130, 2, 1, true]);
                columns[0].push(["ProductAbbrev", "@VT_InProcessing.ProductId", 100, 2, 1, true]);
                columns[0].push(["Specifica", "@VT_InProcessing.Specifica", 130, 2, 1, true]);
                columns[0].push(["PartName", "@VT_InProcessing.PartName", 120, 2, 1, true]);
                columns[0].push(["ProduceQuanlity", "@VT_InProcessing.ProduceQuanlity", 70, 2, 1, true]);
                columns[0].push(["MaterialQuanlity", "@VT_InProcessing.MaterialQuanlity", 70, 2, 1, true]);
                columns[0].push(["", "@VT_InProcessing.PredictScheduPlan", null, 1, 2]);
                columns[0].push(["", "@VT_InProcessing.ScheduPlan", null, 1, 2]);
                columns[1].push(["StartDt", "@VT_InProcessing.StartDate", 90, 1, 1, true]);
                columns[1].push(["ProvideDate", "@VT_InProcessing.ProvideDay", 90, 1, 1, true]);
                columns[1].push(["ScheduStartDt", "@VT_InProcessing.StartDay", 100, 1, 1, false, null, function(value, row, index) {
                    var htmlStr = " processId='" + row["ProcessId"] + "' productId='" + row["ProductId"] + "' scheduQuanlity='" + row["ScheduQuanlity"] + "' isPlaned='" + row["IsPlaned"] + "' targetID='" + row["OrderId"] + "," + row["OrderDetail"] + "," + row["ExportId"] +
                        "' model='start'" + " value='" + Date.Parse(value).Format("yyyy-MM-dd") + "' readonly='true'";
                    return formatterInput("", "", htmlStr);
                }]);
                columns[1].push(["ScheduEndDt", "@VT_InProcessing.FinishDay", 100, 1, 1, false, null, function(value, row, index) {
                    var htmlStr = " targetID='" + row["OrderId"] + "," + row["OrderDetail"] + "," + row["ExportId"] +
                        "' model='end'" + " value='" + Date.Parse(value).Format("yyyy-MM-dd") + "' readonly='true'";
                    return formatterInput("", "", htmlStr);
                }]);
                return columns;
            };

            var monthTableOption = {
                renderDiv: "#monthTable", //renderMsg: "#monthMsg",
                viewType: "day",
                columnWidth: 20,
                width: 350
            };

            //创建edo表格
            var createEdoTable = function(option) {
                createTable(option);
                new ERP.Util({ provider: option.renderDiv, scroller: option.renderDiv + " div.e-table-viewport" });
            };


            var dataIsNull = false; //标识是否为空数据
            //中计划-表格
            var createMiddlePlanGrid = function() {
                Common.Functions.createDataGrid({
                    target: DMPTable,
                    url: "/Produce/InProcessingPlan/GetMiddleData",
                    columns: getMiddlePlanColumns(),
                    sortName: "OrderId,ProductId",
                    sortOrder: "asc,desc",//多字段排序
                    pageSize: 10,
                    pageList: [10,15],
                    maxHeight: 600,
                    checkbox: true,
                    //striped: true,
                    onBeforeLoad: function(param) {
                        if (ERP.Variables.changedRecord.length != 0) { //没有变化时不提交
                            setTimeout(function() {
                                $.messager.confirm("@VT_Common.Tips", "@CM_Produce.DLG40104001", function(r) {
                                    if (r) {
                                        saveMiddlePlanFun();
                                    } else {
                                        ERP.Variables.changedRecord = [];
                                        DMPTable.datagrid("reload");
                                    }
                                });
                            }, 10);
                            return false;
                        }
                        var formArr = DMPForm.serializeArray();
                        for (var i = 0, len = formArr.length; i < len; i++) {
                            param[formArr[i]["name"]] = formArr[i]["value"];
                        }
                        param["IsSearch"] = true;
                        dataIsNull = false;
                    },
                    onCreating: function(data) {
                        setTimeout(function() { //创建拖动区域
                            if (dataIsNull) {
                                $("#monthTable").hide();
                                return;
                            }
                            $("#monthTable").show();
                            var tableOption = monthTableOption;
                            tableOption.data = data.rows;
                            createEdoTable(tableOption);
                            
                        }, 10);
                    },
                    loadFilter: function(data) {
                        var Data = {};
                        Data.rows = data.rows ? data.rows : data;
                        Data.total = data.total ? data.total : 0;
                        AdaptDt(this, Data.rows, "StartDt,ProvideDate,ScheduStartDt,ScheduEndDt");
                        return Data;
                    }
                });
                
            };

            $(function() {
                DMPTable = $(DMPTable); //中计划表格
                DMPForm = $(DMPForm); //detailMonthProcessForm

                ERP.Variables.changedRecord.length = 0; //清除修改记录,保证不影响本次修改
                fieldNames = ERP.Variables.fieldNames;
                fieldNames.ids = { orderId: "OrderId", orderDetail: "OrderDetail", exportId: "ExportId" };
                fieldNames.startDate = "ScheduStartDt";
                fieldNames.endDate = "ScheduEndDt";
                ERP.Variables.UserId = ERP.Variables.UserIds.dxj;

                createMiddlePlanGrid();
                
            });


            $(function () {
                $("#productDlg").dialog({
                    buttons: "#dlgBtns",
                    cache: false,
                    height: 450,
                    //href: "/Technology/ProdInfo/ShowProdInfoDialog?singleSelect=true",
                    modal: true,
                    width: 930,
                    closed: true,
                    title: "<span style=\" font-family:Tahoma,Verdana,微软雅黑,新宋体;font-size:16px;margin:0px;padding:0px; \">产品信息一览</span>",
                    onBeforeOpen: function () {
                        var top = $(document).scrollTop() + ($(window)._outerHeight() - $(this).dialog("options").height) / 2;
                        var left = $(document).scrollLeft() + ($(window)._outerWidth() - $(this).dialog("options").width) / 2;
                        if (top < 10) {
                            top = $(document).scrollTop() + 10;
                        }
                        if (left < 10) {
                            left = $(document).scrollLeft() + 10;
                        }
                        $(this).dialog("move", { top: top, left: left });
                    }
                });

                //打开“产品型号”对话框
                window.showProductDlgFun = function (obj) {
                    $("#productDlg").dialog("open").dialog("refresh", "/Technology/ProdInfo/ShowProdInfoDialog?singleSelect=true")
                        .data("currTarget", $(obj));
                };
                //“产品型号”对话框“确定”按钮
                window.productDlgOKFun = function () {
                    //var selectedRow = $("#ProdInfoDialogTable").datagrid("getSelected");//选择的行数据
                    var selectedRow = null;
                    try {
                        selectedRow = $("#ProdInfoDialogTable").datagrid("getSelected");//选择的行数据
                    } catch (e) {
                        selectedRow = null;
                    }
                    if (!selectedRow) {
                        $.messager.alert("@VT_Common.Tips", "@CM_Produce.CK40502002");
                            return;
                        }
                    var $spanBtn = $("#productDlg").dialog("close").data("currTarget");//放大镜元素
                    var $span = $spanBtn.parent().parent();//span元素
                    $span.children("input").val(selectedRow["ProductAbbreviation"]);
                    $span.prev().val(selectedRow["ProductID"]);
                };
                //打开“零部件名称”对话框
                window.showPartDlgFun = function (obj) {
                    $("#partDlg").data("currTarget", $(obj));
                    ShowProdPartInfo("partDlg", "", "");
                };
                //“零部件名称”对话框“选择”按钮
                window.partDlgOKFun = function () {
                    //var selectedRow = $("#PPInfoTable").datagrid("getSelected");//选择的行数据
                    var selectedRow = null;
                    try {
                        selectedRow = $("#PPInfoTable").datagrid("getSelected");//选择的行数据
                    } catch (e) {
                        selectedRow = null;
                    }
                    if (!selectedRow) {
                        $.messager.alert("@VT_Common.Tips", "@CM_Produce.CK40502002");
                        return;
                    }
                    var $spanBtn = $("#partDlg").dialog("close").data("currTarget");//放大镜元素
                    var $span = $spanBtn.parent().parent();//span元素
                    $span.children("input").val(selectedRow["Name"]);
                    $span.prev().val(selectedRow["Id"]);
                };
                

                //打开“客户订单”对话框
                window.showOrderDlgFun = function (ele) {
                    CommonDlgFun.ShowOrderDlg.call(ele, '#orderDlg');
                };

                //“客户订单”对话框“选择”按钮
                window.orderDlgOKFun = function () {
                    var row = CommonDlgFun.GetSelectedOrder();
                    if (!row) {
                        $.messager.alert("@VT_Common.Tips", "@CM_Produce.CK40502002");
                        return;
                    }
                    $("#orderDlg").dialog("close").data("currTarget").parent().prev().val(row["ClientOrderID"]);

                };

            });


        }(jQuery));

    </script>

}


@*buttons*@
<div style="margin:20px 10px 10px auto;text-align:right;">
    @UserHelpers.ButtonForCapacityAnalysis("",""," disabled='disabled' ")
    @UserHelpers.ButttonForTransferCard("toCirculationCard()")
    @UserHelpers.ButtonForSave("saveMiddlePlanFun()")
    @UserHelpers.ButtonForClose("closeFun()")
</div>

@*title*@
<div style="text-align: center;">
    @UserHelpers.Line()
    @UserHelpers.Company_Title(VT_Common.CompanyName)
    @UserHelpers.Title(VT_InProcessing.ProcessPlanTitle)
</div>

@*form*@
<div style="margin:10px 0;width:auto;margin: 10px auto;">
    <form id="DMPForm" class="Search_Form">
        <div style="width: 870px;margin: auto;">
            <div style="text-align: left;">
                <span>@VT_InProcessing.OrderId：@UserHelpers.InputReadOnly("OrderId","showOrderDlgFun(this)","20")</span>
                <span style="margin-left: 15px;">@VT_InProcessing.ProductId：<input type="hidden" name="ProductId"/>@UserHelpers.InputReadOnly("ProductName","showProductDlgFun(this)","15")</span>
                <span style="margin-left: 15px;">@VT_InProcessing.PartName：<input type="hidden" name="PartId"/>@UserHelpers.InputReadOnly("PartName","showPartDlgFun(this)","15")</span>
                <span style="margin-left: 15px;">@Html.Raw(VT_InProcessing.PlanState)：
                    @UserHelpers.SelectWidget(Constant.MasterSection.PROD_SCHEDU_MIDDLE_STATE,"ScheduState","ScheduState")
                </span>
            </div>
            <div style="text-align: left;margin-top:10px;">
                <span>@Html.Raw(VT_InProcessing.ProvideDate)：@UserHelpers.TimeBeginInput("StartDt","StartDt","StartDt")</span>
                <span style="">~ @UserHelpers.TimeEndInput("EndDt","EndDt","EndDt")</span>
                <span style="margin-left: 59px;">@VT_InProcessing.Specifica：@UserHelpers.InputSimple("Specifica")</span>
                <span style="margin-left:158px;">@UserHelpers.ButtonForSearch("searchMiddlePlanFun('middle')","SearchBtn")</span>
            </div>
        </div>
    </form>
</div>

@*table*@
<div style="width:100%;text-align: center;">
    <div style="width: 1080px;margin:auto;">
        <div class="DMPD datagrid" style="float:left;width:678px;">
            <table id="DMPTable"></table>
        </div>
        <div class="container" style="float:left;width:356px;">
            <div id="monthTable" style=""></div>
        </div>
    </div>
</div>


@*otherForm*@
<form id="saveForm" style="display: none;" method="POST"></form>



@*产品型号dialog相关*@
<div>
    <div id="productDlg"></div>
</div>
<div id="dlgBtns">
    @UserHelpers.ButtonForAdd("productDlgOKFun()")
    @UserHelpers.ButtonForClose("$('#productDlg').dialog('close');")
</div>

@*零部件dialog相关*@
<div>
    <div id="partDlg" data-options="buttons:'#partDlgBtns',modal:true" style1="display: none;"></div>
</div>
<div id="partDlgBtns" style="display: none;">
    @UserHelpers.ButtonForChoose("partDlgOKFun();")
    @UserHelpers.ButtonForClose("$('#partDlg').dialog('close');")
</div>

@*客户订单号dialog相关*@
<div>
    <div id="orderDlg" data-options="buttons:'#orderDlgBtns'"></div>
</div>
<div id="orderDlgBtns" style="display: none;">
    @UserHelpers.ButtonForChoose("orderDlgOKFun();")
    @UserHelpers.ButtonForClose("$('#orderDlg').dialog('close');")
</div>